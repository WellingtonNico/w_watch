<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<script src="w_watch.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bootstrap demo</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	      rel="stylesheet"
	      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
	      crossorigin="anonymous">
</head>
<body>

<div class="row justify-content-center py-5 mx-0">
	<div class="col col-11 col-md-6 text-center">
		<h1>W-Watch</h1>

		<br>
		<br>

		<div class="d-flex flex-column">
			<small class="my-3">Exemplo de atualização de componente diretamente no html</small>
			
			<!-- slider -->
			<input id="id_input_range"
			       type="range"
			       value="50"
			       min="0"
			       max="100"
			       step="0.5">

			<div class="position-relative bg-success overflow-visible mt-1">

				<!-- span com porcentagem -->
				<div class="d-flex rounded px-2 position-absolute"
				     style="background-color: red;left:calc(50%);transform:translateX(-50%)">
					<output w-watch="#id_input_range:input"
					        w-effect="
					          this.value=Number(this.watch.value).toFixed(1)
					          this.parentNode.style.left=`calc(${this.watch.value}%)`
					          let bgColor,color
					          if(this.watch.value>80){
					            bgColor = 'red'
					            color='white'
					          }else if(this.watch.value>50){
					            bgColor = 'yellow'
					            color = 'black'
					          }else{
					            bgColor = 'green'
					            color = 'white'
					          }
					          this.parentNode.style.backgroundColor = bgColor
					          this.parentNode.style.color = color
									">
						
					</output>
					%
				</div>

			</div>
		</div>

		<br>
		<br>
		<br>

		<div>
			<small>Atualizar componente baseado na escrita</small>
			<p>
				<label for="id_input_text">Teste</label>
				<input id="id_input_text" type="text" class="form-control" placeholder="Digite algo aqui"/>
			</p>
			<p>
				<b w-watch="#id_input_text:input"
				   w-effect="this.innerHTML=this.watch.value?this.watch.value:'Digite algo acima'"></b>
			</p>
		</div>

		<br>
		<br>
		<br>

		<div>
			<small>Ocultar e exibir componentes</small>
			<div class="d-flex justify-content-between">

				<!-- radio 1 -->
				<div class="form-check form-switch">
					<input name="name_teste" class="form-check-input" type="radio" role="switch" id="id_switch_1">
					<label class="form-check-label" for="id_switch_1">Exibe componente 1</label>
				</div>

				<!-- radio 2 -->
				<div class="form-check form-switch">
					<input name="name_teste" class="form-check-input" type="radio" role="switch" id="id_switch_2" checked>
					<label class="form-check-label" for="id_switch_2">Exibe componente 2</label>
				</div>
			</div>

			<!-- componente 1 -->
			<div id="componente_1"
			     class="bg-success"
			     w-watch="
			      #id_switch_1:change,
			      #id_switch_1:mouseenter,
			      #id_switch_1:mouseleave 
					"
			     w-effect-0="componente_2.style.display='none';this.style.display='block'"
			     w-effect-1="componente_2.style.backgroundColor='yellow';"
			     w-effect-2="componente_2.style.backgroundColor='blue'"
			><h1>Componente 1</h1></div>

			<!-- componente 2 -->
			<div id="componente_2"
			     style="background-color: blue"
			     w-watch="#id_switch_2:change"
			     w-effect="componente_1.style.display='none';this.style.display='block'"
			><h1>Componente 2</h1></div>
		</div>

		<br>
		<br>

		<small>Contagem de elementos</small>

		<h6>
			<output w-watch="#id_tbody:childList"
			        w-effect="this.value = this.watch.children.length"></output>
			linhas exibidas
		</h6>

		<h6>
			<output w-watch="#id_tbody:childList,#id_tbody:click"
			        w-effect="this.value = this.watch.querySelectorAll('input:checked').length"
			></output>
			Checkbox Selecionadas
		</h6>

		<h6>
			Total =
			<output w-watch="#id_tbody:childList,#id_tbody:click"
			        w-effect="
			          this.value = [
			            ...this.watch.querySelectorAll('input:checked')
			          ].reduce((p,a)=>p+Number(a.value),0)
								"
			></output>

		</h6>

		<script>

      function adicionarLinhaNaTabela() {
        const tr = document.createElement('tr')
        tr.innerHTML = `
					<td>
						<input value="333" type="checkbox" class="form-check"
					       >
					</td>
					<td>1</td>
					<td>teste</td>
					<td class="text-end">
						<button onclick="this.closest('tr').remove()" class="btn btn-danger">remover</button>
					</td>
				`
        id_tbody.appendChild(tr)
      }
		</script>

		<div class="table-responsive">
			<table class="table table-striped">
				<thead>
				<tr>
					<th></th>
					<th>id</th>
					<th>nome</th>
					<th class="text-end">
						<!-- botão para adicionar mais linhas -->
						<button onclick="adicionarLinhaNaTabela()"
						        class="btn btn-primary">+
						</button>
					</th>
				</tr>
				</thead>
				<tbody id="id_tbody">
				<tr>
					<td>
						<input value="333" type="checkbox" class="form-check"
						>
					</td>
					<td>1</td>
					<td>teste</td>
					<td class="text-end">
						<button w-watch="closest tbody:click" w-effect="console.log('testando funcionamento')" onclick="this.closest('tr').remove()" class="btn btn-danger">remover</button>
					</td>
				</tr>
				<tr>
					<td>
						<input value="333" type="checkbox" class="form-check"
						>
					</td>
					<td>1</td>
					<td>teste</td>
					<td class="text-end">
						<button onclick="this.closest('tr').remove()" class="btn btn-danger">remover</button>
					</td>
				</tr>
				<tr>
					<td>
						<input value="333" type="checkbox" class="form-check"
						>
					</td>
					<td>1</td>
					<td>teste</td>
					<td class="text-end">
						<button onclick="this.closest('tr').remove()" class="btn btn-danger">remover</button>
					</td>
				</tr>
				<tr>
					<td>
						<input value="333" type="checkbox" class="form-check"
						>
					</td>
					<td>1</td>
					<td>teste</td>
					<td class="text-end">
						<button onclick="this.closest('tr').remove()" class="btn btn-danger">remover</button>
					</td>
				</tr>

				</tbody>

			</table>
		</div>
	</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>
</html>
